@(dbname: String, query: String, innerHtml: String, results: Seq[ResultObj])

@main(s"Per Object: $query") {

    <ul class="largehint">
        <li><a class="largehint" href='@routes.PerClassController.query(dbname, query)'>Per-class analysis of current objects.</a></li>
        <li><a class="largehint" href='@routes.PerAllocationSiteController.query(dbname, query)'>Per-allocation-site analysis of current objects.</a></li>
        <li><a class="largehint" href='@routes.TimingController.query(dbname, query)'>Lifetime analysis of current objects.</a></li>
        <li><a class="largehint" href='@routes.QueryController.query(dbname, s"Not($query)")'>Not(..) - Negate current query.</a></li>
        <li><a class="largehint" href='@routes.QueryController.query(dbname, s"Deeply($query)")'>Deeply(..) - Deep query.</a></li>
        <li><a class="largehint" href='@routes.QueryController.query(dbname, s"ReachableFrom($query)")'>ReachableFrom(..) - All objects reachable from current objects.</a></li>
        <li><a class="largehint" href='@routes.QueryController.query(dbname, s"CanReach($query)")'>CanReach(..) - All objects that can reach the current objects.</a></li>
    </ul>

    <h2>Per Object: @query</h2>

    @helper.form(action = routes.QueryController.queryDataPost(dbname)) {
        <div class="result" style="overflow-y: scroll; height: 100%;">

            <table id="resultTable" class="tablesorter selectable">
                <thead>\
                    <tr>
                        <th></th>
                        <th>Obj. ID</th>
                        <th>Class</th>
                        <th>Allocation Site</th>
                    </tr>
                </thead>
                <tbody>
                    @Html(
                        results.map {
                            x =>
                                "    <tr class='ui-selectable-default'>\n" +
                                        "      <td><input name='chk-" + x.id + "' type='checkbox'/></td>\n" +
                                        "      <td class=\"object-id\">" + AproposControllerUtil.oidWithHint(dbname, x.klass, x.id) + "</td>\n" +
                                        QueryControllerUtil.classNameToTd(dbname, query, x.klass) +
                                        "      <td>" +
                                        x.allocationSite
                                                .filter(str => {
                                            !(str.startsWith("<") || str.contains(":-1"))
                                        })
                                                .getOrElse("<span class='empty'>N/A</span>") +
                                        "</td>\n" +
                                        "    </tr>"
                        }.mkString("\n")
                    )
                </tbody>
            </table>
        </div>
        <input type="submit" value="Select objects"/>
    }
}
